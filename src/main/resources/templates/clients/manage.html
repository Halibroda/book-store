<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="uk">
<head th:replace="~{fragments/_head :: head(#{clients.manage})}"></head>
<body>
<div th:replace="~{fragments/_navbar :: navbar}"></div>
<main class="container">
    <h1 th:text="#{clients.manage}">Клієнти</h1>

    <div th:if="${success}" class="alert alert-success" th:text="${success}">OK</div>

    <table class="table">
        <thead>
        <tr>
            <th>ID</th><th>Email</th><th th:text="#{clients.name}">Ім’я</th>
            <th th:text="#{clients.balance}">Баланс</th><th th:text="#{clients.status}">Статус</th><th></th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="c : ${clients}">
            <td th:text="${c.id}">1</td>
            <td th:text="${c.email}">user@example.com</td>
            <td th:text="${c.name}">User</td>
            <td th:text="${#numbers.formatDecimal(c.balance,1,'COMMA',2,'POINT')}">0.00</td>

            <td>
                  <span th:if="${c.enabled != null}"
                        th:class="${c.enabled} ? 'badge badge--ok' : 'badge badge--bad'"
                        th:text="${c.enabled} ? #{status.active} : #{status.blocked}">
                    Active
                  </span>
                <span th:if="${c.enabled == null}">—</span>
            </td>

            <td class="actions">
                <form th:if="${c.enabled == null or c.enabled}"
                      th:action="@{|/clients/${c.email}/block|}"
                      method="post" class="inline"
                      th:onsubmit="|return confirm('#{clients.block.confirm}')|">
                    <input type="hidden" th:if="${_csrf}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button class="btn btn--danger" th:text="#{clients.block}">Block</button>
                </form>

                <form th:if="${c.enabled == null or !c.enabled}"
                      th:action="@{|/clients/${c.email}/unblock|}"
                      method="post" class="inline">
                    <input type="hidden" th:if="${_csrf}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <button class="btn" th:text="#{clients.unblock}">Unblock</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</main>
</body>
</html>
